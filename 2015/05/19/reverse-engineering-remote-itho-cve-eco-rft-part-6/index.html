<!DOCTYPE html>
<html lang="en">
    
    


    <head>
    <link href="https://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="public" />
<!-- Enable responsiveness on mobile devices -->
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.51" />

    
    
    

<title>Reverse engineering remote Itho CVE ECO RFT – Part 6 • Rogier&#39;s blog</title>


<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Reverse engineering remote Itho CVE ECO RFT – Part 6"/>
<meta name="twitter:description" content="Finally I&rsquo;ve made a huge step forward in actually controlling the Itho ventilation box from my arduino, using a CC1150 RF-transmitter. This wouldn&rsquo;t have been possible without Sander letting me swap my Itho remote control for his remote control, so thanks Sander!
If you are not interested in how I got this working, but want to see it working for yourself, head straight on over to my GitHub repository and download the code: https://github."/>

<meta property="og:title" content="Reverse engineering remote Itho CVE ECO RFT – Part 6" />
<meta property="og:description" content="Finally I&rsquo;ve made a huge step forward in actually controlling the Itho ventilation box from my arduino, using a CC1150 RF-transmitter. This wouldn&rsquo;t have been possible without Sander letting me swap my Itho remote control for his remote control, so thanks Sander!
If you are not interested in how I got this working, but want to see it working for yourself, head straight on over to my GitHub repository and download the code: https://github." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.progz.nl/blog/2015/05/19/reverse-engineering-remote-itho-cve-eco-rft-part-6/" /><meta property="article:published_time" content="2015-05-19T07:33:10&#43;02:00"/>
<meta property="article:modified_time" content="2015-05-19T07:33:10&#43;02:00"/>


    


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">








<link rel="stylesheet" href="/blog/scss/hyde-hyde.173e0dc3bb8c6a72b7f6415bdbae34b6521efd304b087c69ab48bddcf583090a.css" integrity="sha256-Fz4Nw7uManK39kFb2640tlIe/TBLCHxpq0i93PWDCQo=">


<link rel="stylesheet" href="/blog/scss/print.2744dcbf8a0b2e74f8a50e4b34e5f441be7cf93cc7de27029121c6a09f9e77bc.css" integrity="sha256-J0Tcv4oLLnT4pQ5LNOX0Qb58&#43;TzH3icCkSHGoJ&#43;ed7w=" media="print">



    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    

</head>


    <body class="theme-progz ">
    
<div class="sidebar">
  <div class="container ">
    <div class="sidebar-about">
      <span class="site__title">
        <a href="https://www.progz.nl/blog">Rogier&#39;s blog</a>
      </span>
      
        
        
        
        <div class="author-image">
          <img src="https://www.progz.nl/blog/img/Rogier-Reedijk.jpg" alt="Author Image" class="img--circle img--headshot element--center">
        </div>
        
      
      
      <p class="site__description">
        
      </p>
    </div>
    <div class="collapsible-menu">
      <input type="checkbox" id="menuToggle">
      <label for="menuToggle">Rogier&#39;s blog</label>
      <div class="menu-content">
        <div>
	<ul class="sidebar-nav">
		 
		 
			 
				<li>
					<a href="/blog/about/">
						<span>About</span>
					</a>
				</li>
			 
		
		</li>
	</ul>
</div>

        <section class="social">
	
	<a href="https://twitter.com/xs4free" rel="me"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a>
	
	
	<a href="https://facebook.com/rogier.reedijk" rel="me"><i class="fab fa-facebook-f"></i></a>
	
	
	<a href="https://github.com/xs4free" rel="me"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	<a href="https://linkedin.com/in/rogierreedijk" rel="me"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	
	
	
</section>

      </div>
    </div>
    
<div class="copyright">
  &copy; 2018 Rogier Reedijk
  
    <a href="https://creativecommons.org/licenses/by-sa/4.0">CC BY-SA 4.0</a>
  
</div>


<div class="builtwith">
Built with <a href="https://gohugo.io">Hugo</a> ❤️ <a href="https://github.com/htr3n/hyde-hyde">hyde-hyde</a>.
</div>


  </div>
</div>

        <div class="content container">
            
    <article>
  <header>
    <h1>Reverse engineering remote Itho CVE ECO RFT – Part 6</h1>
    
    
<div class="post__meta">
    
    
      <i class="fas fa-calendar-alt"></i> May 19, 2015
    
    
    
      
      
          in
          
          
              <a class="badge badge-category" href="/blog/categories/homeautomation">HOMEAUTOMATION</a>
              
          
      
    
    
    
      
      
          <br/>
           <i class="fas fa-tags"></i>
          
          <a class="badge badge-tag" href="/blog/tags/arduino">arduino</a>
           
      
          <a class="badge badge-tag" href="/blog/tags/cc1150">cc1150</a>
           
      
          <a class="badge badge-tag" href="/blog/tags/itho">itho</a>
          
      
    
    
    <br/>
    <i class="fas fa-clock"></i> 7 min read
</div>


  </header>
  
  
  <div class="post">
    <p>Finally I&rsquo;ve made a huge step forward in actually controlling the Itho ventilation box from my arduino, using a CC1150 RF-transmitter. This wouldn&rsquo;t have been possible without Sander letting me swap my Itho remote control for his remote control, so thanks Sander!</p>

<p>If you are not interested in how I got this working, but want to see it working for yourself, head straight on over to my GitHub repository and download the code: <a href="https://github.com/xs4free/Itho-library">https://github.com/xs4free/Itho-library</a>. Take a look at the <a href="https://github.com/xs4free/Itho-library/tree/master/examples/AllFourButtons">AllFourButtons</a> example. If you have a CC1150 RF transmitter, an Arduino Pro Mini (running at 3.3V) and 4 tactile switches, you can control an Itho RFT ventilation box by wiring up the compents like this:</p>

<p>

<figure class="no-photoswipe">
    <img src="/blog/2015/05/19/reverse-engineering-remote-itho-cve-eco-rft-part-6/Itho_4_buttons_schema_hubf6e75fe31511745a0151fdb540200e4_79658_750x750_fit_box_2.png" alt="Itho 4 buttons schema" class="img-fluid" />
	
</figure>


<figure class="no-photoswipe">
    <img src="/blog/2015/05/19/reverse-engineering-remote-itho-cve-eco-rft-part-6/Itho_4_buttons_breadboard_hufd5bd207aaf21fd1eccc6fbd9f8b4835_71934_750x750_fit_q75_box.jpg" alt="Itho 4 buttons breadboard" class="img-fluid" />
	
</figure></p>

<p>In retrospect I had to solve 3 problems to get the code working:</p>

<ol>
<li>Know which fields contain the identity of the remote control (so I can re-create that number or create a fake number)</li>
<li>Find out what the last 2 bytes in the first part of the message mean</li>
<li>Find out what the 2 sets of bytes mean in the second part of the message that keep on changing every button press</li>
</ol>

<p>The first problem (I thought) I had, was not knowing which bytes in the message actually contain the remotes unique identifier. My theory was that I had to generate another identifier for my Arduino based remote, or else the original remote would not work anymore. In the end it turns out both remotes work just fine when used interchangeable, but I didn&rsquo;t know that up front. So I asked my colleague Sander if I could borrow his remote. That way I could analyze the messages being sent from his remote and analyze the differences. For each button press the Itho remote sents out 6 short RF messages. The first and second message are unique, the 4 messages after that are only repeats of the first 2. The first message contains 20 bytes in total, 6 bytes where different between the first and second remote. The second message contains 51 bytes in total, 5 bytes where different between the first and second remote. These were the only bytes that changed between the 2 remote controls, but stayed the same between 2 button presses on the same remote. I&rsquo;m assuming the Itho ventilation box remembers these numbers when you preform the &ldquo;join&rdquo; operation when the ventilation box is turned on for the first time. Anyone using my code should perform a join first (untested yet!) with the identifiers in my code, before an Itho ventilation box will accept commands from the Arduino.</p>

<p>When I was analyzing the first message being sent for each button press, I noticed that the last 2 bytes only use a limited number of values. After looking at all the traces I had recorded I concluded that the last 2 bytes specify the previous command sent by the controller. So if the previous command was &ldquo;go to low speed&rdquo; and the command being sent now was &ldquo;go to full speed&rdquo;, the last two bytes of the first message would always be 85 and 77 (low speed). Each button/command has it&rsquo;s own unique combination for these 2 bytes.</p>

<p>The second message that is being sent when a button is pressed, contains 51 bytes of data. This message contains 6 bytes that change every time you press a button (even if you keep pressing the same button over and over again). The only explanation I could think of, was that these bytes had to form a number that gets incremented with each button press. To find out what logic is being used to generate these numbers I put the 6 changing numbers in their own excelsheet and started searching for patterns and applying formulas. After a lot of searching I discovered that the 6 bytes formed 2 numbers, one that <strong>de</strong>crementes every button press and one that increments/decrementes based on the button that is being pressed and the previous button that was pressed before it. For example, if the Itho is running at low speed (was the last button pressed), and counter 1 currently has the value 100 and counter 2 has the value 200:</p>

<table>
<thead>
<tr>
<th>Itho current speed</th>
<th>low</th>
<th>low</th>
<th>high</th>
<th>high</th>
<th>timer</th>
</tr>
</thead>

<tbody>
<tr>
<td>Button pressed</td>
<td></td>
<td>high</td>
<td>high</td>
<td>timer</td>
<td>medium</td>
</tr>

<tr>
<td>Message 1 last 2 bytes</td>
<td></td>
<td>85, 77</td>
<td>85, 53</td>
<td>85, 53</td>
<td>85, 85</td>
</tr>

<tr>
<td>Message 2 counter 1</td>
<td>100</td>
<td>99</td>
<td>98</td>
<td>97</td>
<td>96</td>
</tr>

<tr>
<td>Message 2 counter 2</td>
<td>200</td>
<td>203 (+3)</td>
<td>204 (+1)</td>
<td>210 (+6)</td>
<td>206 (-4)</td>
</tr>
</tbody>
</table>

<p>The counters in message 2 are not simply stored in two bytes, but are split across the bits of 3 bytes. The assumption I made in my excelsheets, to convert the binary bits back to bytes, actually made it harder for me to see these number. For example, if bytes 26, 27 and 28 of the first message contain the values 150, 150 and 166, then the number we are looking for is 99. How did I calculate this number? First you convert the byte values to bits, so 150 becomes: <code>10010110</code> and 166 becomes: <code>10100110</code>. If you put all 3 binary numbers after each other you get <code>10010110 10010110 10100110</code>. Now take the 10th bit (from the left), the 8th bit, the 6th, 4th, 2nd, 18th, 16th, 14th and 12th. If you put these bits after each other, you get: <code>001100011</code>. If you convert this binary number back to decimal, you get 99. The fun part for this counter is, that besides the number 99 the Itho remote always sends another number along with this counter. To calculate the value of the other number you substract the value of the counter (99) from 511, so the second number would be 511 - 99 = 412.
The second counter in message 2 uses the same kind of formula, only the first bit of the counter does not start at the 10th bit, but at the 14th bit.</p>

<p>So my current understanding of the protocol the Itho remote uses to communicate with the ventilationbox is as follows:</p>

<p>Message 1:</p>

<table>
<thead>
<tr>
<th>Byte start</th>
<th>Byte end</th>
<th>Default value</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>1</td>
<td>3</td>
<td>170</td>
<td>Start of the message (10101010 x 3)</td>
</tr>

<tr>
<td>4</td>
<td>6</td>
<td>173,51,83</td>
<td>header</td>
</tr>

<tr>
<td>7</td>
<td>9</td>
<td></td>
<td>id of the remote</td>
</tr>

<tr>
<td>10</td>
<td>10</td>
<td></td>
<td>id (7 bits) + command (1 bit)</td>
</tr>

<tr>
<td>11</td>
<td>13</td>
<td></td>
<td>The command</td>
</tr>

<tr>
<td>14</td>
<td>14</td>
<td></td>
<td>command (7 bits) + checksum (1 bit)</td>
</tr>

<tr>
<td>15</td>
<td>16</td>
<td></td>
<td>checksum (command specific)</td>
</tr>

<tr>
<td>17</td>
<td>17</td>
<td>170</td>
<td>footer</td>
</tr>

<tr>
<td>18</td>
<td>18</td>
<td>171</td>
<td>footer</td>
</tr>

<tr>
<td>19</td>
<td>19</td>
<td></td>
<td>Fixed value for the previous command: register = 77, unregister = 82, low/medium/full/timer = 85.</td>
</tr>

<tr>
<td>20</td>
<td>20</td>
<td></td>
<td>Fixed value for the previous command: register = 77, unregister = 171, low = 77, medium = 75, full = 53, timer = 85.</td>
</tr>
</tbody>
</table>

<p>Message 2:</p>

<table>
<thead>
<tr>
<th>Byte start</th>
<th>Byte end</th>
<th>Default value</th>
<th>Description</th>
</tr>
</thead>

<tbody>
<tr>
<td>1</td>
<td>7</td>
<td>170</td>
<td>Start of the message (10101010 x 7)</td>
</tr>

<tr>
<td>8</td>
<td>16</td>
<td>171,254,0,179,42,171,42,149,154</td>
<td>header</td>
</tr>

<tr>
<td>17</td>
<td>24</td>
<td></td>
<td>id of the remote</td>
</tr>

<tr>
<td>25</td>
<td>26</td>
<td></td>
<td>counter 1</td>
</tr>

<tr>
<td>27</td>
<td>27</td>
<td></td>
<td>counter 1 (2 bits) + command (6 bits)</td>
</tr>

<tr>
<td>28</td>
<td>41</td>
<td></td>
<td>command</td>
</tr>

<tr>
<td>42</td>
<td>42</td>
<td></td>
<td>command (4 bits) + counter 2 (4 bits)</td>
</tr>

<tr>
<td>43</td>
<td>43</td>
<td></td>
<td>counter 2</td>
</tr>

<tr>
<td>44</td>
<td>44</td>
<td></td>
<td>counter 2 (6 bits) + footer (2 bits)</td>
</tr>

<tr>
<td>45</td>
<td>50</td>
<td></td>
<td>footer command specific: for join command (2, 165, 169, 169, 154, 86, 85, 5) for all other commands (2, 172, 170, 170, 170, 170, 170, 7)</td>
</tr>

<tr>
<td>51</td>
<td>51</td>
<td></td>
<td>footer (3 bits)</td>
</tr>
</tbody>
</table>

<p>For my needs, the above code works perfectly. I do have a few future tasks and ideas:</p>

<ol>
<li>Convert the code to be commandable via the serial port and change the schema to work safely on a Arduino Nano (that can easily be hooked up to an Cubietruck or Raspberry Pi)</li>
<li>Test the join and leave commands so others can use my code without knowing their own remotes unique identifier</li>
<li>Get this code working with an CC1101, so I can also listen/receive the buttons presses from the regular remote</li>
<li>Duration test</li>
<li>Compare my findings with the results Klusjesman (a commenter on this blog) sent me.</li>
</ol>

<p>If you are going to use my Itho (CC1150) code, please drop me a line in the comments below. I would love to hear your experiences and ideas!</p>

<p><strong>Other posts in this serie:</strong> <a href="https://www.progz.nl/blog/2014/12/reverse-engineering-remote-itho-cve-eco-rft-part-1/" title="Reverse engineering remote Itho CVE ECO RFT – Part 1">Part 1</a>, <a href="https://www.progz.nl/blog/2014/12/reverse-engineering-remote-itho-cve-eco-rft-part-2/" title="Reverse engineering remote Itho CVE ECO RFT – Part 2">Part 2</a>, <a href="https://www.progz.nl/blog/2015/01/reverse-engineering-remote-itho-cve-eco-rft-part-3/" title="Reverse engineering remote Itho CVE ECO RFT – Part 3">Part 3</a>, <a href="https://www.progz.nl/blog/2015/02/reverse-engineering-remote-itho-cve-eco-rft-part-4/" title="Reverse engineering remote Itho CVE ECO RFT – Part 4">Part 4</a>, <a href="https://www.progz.nl/blog/2015/02/reverse-engineering-remote-itho-cve-eco-rft-part-5/">Part 5</a></p>

  </div>
  

<div class="navigation navigation-single">
    
    <a href="https://www.progz.nl/blog/2016/11/25/getting-started-with-mysensors/" class="navigation-prev">
      <i aria-hidden="true" class="fa fa-chevron-left"></i>
      <span class="navigation-tittle">Getting started with MySensors</span>
    </a>
    
    
    <a href="https://www.progz.nl/blog/2015/02/18/reverse-engineering-remote-itho-cve-eco-rft-part-5/" class="navigation-next">
      <span class="navigation-tittle">Reverse engineering remote Itho CVE ECO RFT – Part 5</span>
      <i aria-hidden="true" class="fa fa-chevron-right"></i>
    </a>
    
</div>


  

  
    
        <section class="comments-area">
  <a id="comments"></a>

  
  

  
    
  

  
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
         

    
    <h3><i class="fas fa-comment-alt"></i> 128 replies on “Reverse engineering remote Itho CVE ECO RFT – Part 6”</h3>

    <ol>
    
      
      <li>
        <article id="comment-31">
          <div class="d-flex">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/CF8A52B00AAAFF5039DFBB43F5D09462?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Klusjesman
                
              </div>
              <small>
                <a href="#comment-31" title="Link naar deze reactie">
                  <time>Saturday 20 Jun 2015 om 13:43:26</time>
                  
                </a>
              </small>
              <p><p>Hi Rogier,</p>

<p>You have made some nice progress and unraveled interesting details. Unfortunately I don&rsquo;t have much time to play with my project because of work abroad. Also some parts are still traveling somewhere around the world. So no progress for me at the moment. I will keep you informed.</p>

<p>Gr,
Patrick</p>
</p>
            </div>
          </div>
          <hr class="blog-seperator"/>
        </article>
        <ol class="children">

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

</ol>
      </li>
      
    
      
      <li>
        <article id="comment-32">
          <div class="d-flex">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/8E05445CB6D873C66D69B16EC80E4DB4?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                HansB
                
              </div>
              <small>
                <a href="#comment-32" title="Link naar deze reactie">
                  <time>Sunday 1 Nov 2015 om 16:12:12</time>
                  
                </a>
              </small>
              <p><p>Hi Rogier,</p>

<p>Thanks for your very interesting blog! I would love to experiment with the components &amp; software you provide, but cannot find an 868 MHz CC1150 module, only an 433 MHz one (which, from the photo, looks exactly like the one on your blog). Do you have any suggestions? Is the 433 MHz module easily reconfiguarble to 868 MHz?</p>

<p>Thanks &amp; best regards,</p>

<p>Hans.</p>
</p>
            </div>
          </div>
          <hr class="blog-seperator"/>
        </article>
        <ol class="children">

  

  

  
    <li>
      <article id="comment-33">
          <div class="d-flex flex-row">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/7F2A9FD369018735070D34C0331FE9C5?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Rogier Reedijk reply to HansB
                
              </div>
              <small>
                <a href="#comment-33" title="Link naar deze reactie">
                  <time>Sunday 1 Nov 2015 om 17:46:02</time>
                  
                </a>
              </small>
              <p><p>Hi Hans,</p>

<p>I&rsquo;ve quickly searched eBay and AliExpress for a CC1150 at 868MHz, but could not find any. I&rsquo;ve read the datasheet thoroughly and there is a difference between the 868 MHz and the 433 MHz boards, the difference is in the resistors between the CC1150 and the antenna. As I see it, you have a couple of options:
1) use the CC1150 433 MHz board and just try it.
2) use a CC1101 868 MHz board and adjust my code. You can buy this board on eBay, for example: <a href="http://r.ebay.com/HiXi4a">http://r.ebay.com/HiXi4a</a>
3) try to approach a Chinese seller that sells the CC1150 433 MHz boards and ask if they also have the 868 MHz boards</p>

<p>I can&rsquo;t look at your budget, but I would try options 1 and 2 in parallel. Order both boards and see which arrives first. Worst case for option 1 is that the fan won&rsquo;t respond because the signal does not get through. Option 2 entails looking up the register differences between the CC1150 and the CC1101. Since both chips share the same datasheet this should not be too hard. The only difference between the CC1150 and the CC1101 is that the CC1101 also has the abillity to listen to RF, the CC1150 is send-only.</p>

<p>Option 2 has been on my todo-list for a while. I haven&rsquo;t gotten around to it, because I&rsquo;m in the process of moving to a different house. So sadly I currently have no time to tinker with electronics.</p>

<p>Let me know which option you choose and if you have any questions, just ask! I will try to help you any way I can.</p>
</p>
            </div>
          </div>      
        </article>
        <hr class="blog-seperator"/>
    </li>
  

  
    <li>
      <article id="comment-34">
          <div class="d-flex flex-row">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/CF8A52B00AAAFF5039DFBB43F5D09462?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Klusjesman reply to HansB
                
              </div>
              <small>
                <a href="#comment-34" title="Link naar deze reactie">
                  <time>Sunday 1 Nov 2015 om 18:02:22</time>
                  
                </a>
              </small>
              <p><p>The one I bought also looks exactly like the image and is 868 MHz. I bought it on ebay i think, or aliexpress. w-tx1150 is written on the small board. I just checked it but I am not able to find the same component on the sites i mentioned earlier.</p>

<p>Some while ago I played with the cc1150. I was able to communicate with it and set the frequency and do a read out etc. So my 3v-5.5v conversion with some mosfets and resistors were also working nicely. When I wanted to start sending messages to the ventilation unit I ran into some strange atmega problems (reset). Turned out I didn;t have enough memory on board, so I bought some other atmega&rsquo;s. But since then I didn;t touch the configuration anymore. I&rsquo;m just to busy with my company. So I guess this will be a long term project for me.</p>

<p>I will order some CC1101, just in case I find some time to play.</p>
</p>
            </div>
          </div>      
        </article>
        <hr class="blog-seperator"/>
    </li>
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

</ol>
      </li>
      
    
      
    
      
    
      
    
      
      <li>
        <article id="comment-36">
          <div class="d-flex">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/F0D6E096FD45271B1A8CE970F035B72B?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Jimmy
                
              </div>
              <small>
                <a href="#comment-36" title="Link naar deze reactie">
                  <time>Thursday 11 Feb 2016 om 13:15:53</time>
                  
                </a>
              </small>
              <p>On ebay I found, and ordered, this module: <a href="http://www.ebay.com/itm/281431437869">http://www.ebay.com/itm/281431437869</a>
The title says 433Mz, but the description has &ldquo;Operating in the 315/433/868/915 MHz ISM/SRD bands&rdquo;.
Would this module work?
My coding and electronics skills are not very good. If I try and it does not work, would leave me with the question if it&rsquo;s the module or something I did wrong.<br />
(buying a 1101 would also be a possibility but I really don&rsquo;t understand what I would have to change for that)</p>
            </div>
          </div>
          <hr class="blog-seperator"/>
        </article>
        <ol class="children">

  

  

  

  

  

  

  
    <li>
      <article id="comment-37">
          <div class="d-flex flex-row">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/7F2A9FD369018735070D34C0331FE9C5?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Rogier Reedijk reply to Jimmy
                
              </div>
              <small>
                <a href="#comment-37" title="Link naar deze reactie">
                  <time>Thursday 11 Feb 2016 om 18:50:40</time>
                  
                </a>
              </small>
              <p>Hoi Jimmy, I haven&rsquo;t tried a 433MHz module myself, so I cannot definitely comfirm if it will work or not.
My best guess is that it won&rsquo;t work, or maybe with a very reduced range. The contradicting specs that you&rsquo;ve read are that the CC1150 chips supports all frequencies, but the design of board determines which filters are used between the chip and the antenna. If you open the data sheet for the CC1150, you can find a reference design for a 433 and one for a 866 MHz board. Judging from the photo and the title of article that you found, this is actually the 433 MHz version. That means the filters on this board will most likely cancel out most of the 866 MHz transmission that you want to sent to the Itho.
If you don&rsquo;t want to much trouble, try to get a 866MHz board.</p>
            </div>
          </div>      
        </article>
        <hr class="blog-seperator"/>
    </li>
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

</ol>
      </li>
      
    
      
    
      
      <li>
        <article id="comment-38">
          <div class="d-flex">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/F0D6E096FD45271B1A8CE970F035B72B?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Jimmy
                
              </div>
              <small>
                <a href="#comment-38" title="Link naar deze reactie">
                  <time>Monday 15 Feb 2016 om 06:48:36</time>
                  
                </a>
              </small>
              <p>Hoi Rogier, thanks, yes I discovered how it &ldquo;works&rdquo; in the datasheet. It doesn&rsquo;t seem to be changeable easy. Do you know if somebody has used the 868MHz version of the 1101? Because I can&rsquo;t find a 1105 at 868MHz but I can find the 1101 at 868MHz (will take another 3 weeks on ebay).  People above spoke about it but nobody shared his experiences afterwards.</p>
            </div>
          </div>
          <hr class="blog-seperator"/>
        </article>
        <ol class="children">

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

</ol>
      </li>
      
    
      
      <li>
        <article id="comment-39">
          <div class="d-flex">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/E9B065791ED4A486DFD886253E1A21E0?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Marcel
                
              </div>
              <small>
                <a href="#comment-39" title="Link naar deze reactie">
                  <time>Thursday 18 Feb 2016 om 08:30:02</time>
                  
                </a>
              </small>
              <p>Hoi, interesting blog! I also searched for the CC1150 on 868MHz but couldn&rsquo;t find it so I ordered a 1101. You started with the 1101, do you still have the code and could you share it?</p>
            </div>
          </div>
          <hr class="blog-seperator"/>
        </article>
        <ol class="children">

  

  

  

  

  

  

  

  

  

  

  
    <li>
      <article id="comment-41">
          <div class="d-flex flex-row">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/7F2A9FD369018735070D34C0331FE9C5?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Rogier Reedijk reply to Marcel
                
              </div>
              <small>
                <a href="#comment-41" title="Link naar deze reactie">
                  <time>Saturday 20 Feb 2016 om 21:36:35</time>
                  
                </a>
              </small>
              <p><p>Hi Marcel,
I&rsquo;ve searched my development machine, but can&rsquo;t seem to find the old (CC1101) versions of my code. I should have started using GitHub straight away&hellip;
In my previous posts there are a few links to the CC1101 libraries I used. Maybe they are useful for you as well?
Most of the code should be the same, since the CC1101 and CC1150 share a lot of registers. The only big difference between the CC1101 and CC1150 is that the CC1101 is also a receiver, because of that you will need to make a few extra calls to switch to transmit mode (which the CC1150 defaults to straight away).
I would love to experiment with the CC1101 my self, but I recently moved and all my parts are still in moving-boxes. I also don&rsquo;t have an Itho ventilation unit in my new house YET, so it&rsquo;s probably going to be a few more months before I&rsquo;m up and running again.
If you have written any code in the mean time, please let me know. I would love to take a look and help you out in any way I can.</p>

<p>Regards, Rogier.</p>
</p>
            </div>
          </div>      
        </article>
        <hr class="blog-seperator"/>
    </li>
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

</ol>
      </li>
      
    
      
      <li>
        <article id="comment-40">
          <div class="d-flex">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/FA488DE7A20DF9A0E0805F50B0B0F9F2?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Erwin
                
              </div>
              <small>
                <a href="#comment-40" title="Link naar deze reactie">
                  <time>Saturday 20 Feb 2016 om 14:47:20</time>
                  
                </a>
              </small>
              <p><p>Hi Rogier,</p>

<p>I got exactly the same module by the looks of it ( <a href="http://www.ebay.com/itm/281431437869">http://www.ebay.com/itm/281431437869</a> ), chip has 1150 number on it but sadly no luck on a working thing. I can send a join command but the Itho does not respond.</p>

<p>Have you had any chance on further exploring this thing, maybe make some code to &lsquo;listen&rsquo; with the cc1150 to the current remote control or something like that ?</p>

<p>Great work so far !</p>
</p>
            </div>
          </div>
          <hr class="blog-seperator"/>
        </article>
        <ol class="children">

  

  

  

  

  

  

  

  

  

  

  

  
    <li>
      <article id="comment-42">
          <div class="d-flex flex-row">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/7F2A9FD369018735070D34C0331FE9C5?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Rogier Reedijk reply to Erwin
                
              </div>
              <small>
                <a href="#comment-42" title="Link naar deze reactie">
                  <time>Saturday 20 Feb 2016 om 21:47:59</time>
                  
                </a>
              </small>
              <p>Hey Erwin,
Listening to the current remote and extracting the id is a task that is high up on my wishlist/todo-list. Sadly, this won&rsquo;t be possible with the CC1150, since this is a transmit-only chip. If you want to listen/receive you need the CC1101 chip. The link you sent is to a 1150 chip with a filter set for the 433 MHz band. So that might just be a very reasonable explanation why your Itho isn&rsquo;t responding to the join command you sent (the Itho is only using the 868 MHz band).
Just to double check, are you removing the power from the ventilation-unit and sending the signal during the first two minutes after you restore power? Because that is the only moment the Itho ventilation-unit will allow new remotes to join.
Since my last blogpost I moved to another house and sadly the new house doesn&rsquo;t contain a Itho ventilation unit YET. In the next few months I will most likely install an Itho unit and start working on this project again. In the mean time I will search for a CC1101 chipset on 868 MHz and link it in on this blog, because a lot of people are asking trying to recreate my setup and want to use my code.
In the mean time, if you have any progress with you setup, please let me know!</p>
            </div>
          </div>      
        </article>
        <hr class="blog-seperator"/>
    </li>
  

  

  
    <li>
      <article id="comment-44">
          <div class="d-flex flex-row">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/F0D6E096FD45271B1A8CE970F035B72B?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Jimmy reply to Erwin
                
              </div>
              <small>
                <a href="#comment-44" title="Link naar deze reactie">
                  <time>Friday 4 Mar 2016 om 07:55:50</time>
                  
                </a>
              </small>
              <p>Same problem here with the ebay cc1150, it looks like sending join (and the other codes when pressing the buttons), but the itho does not respond. I know I have a 433MHz version, just like ERWIN, but that&rsquo;s only a difference in the antanna filters (making transmission range on 868MHz bad). When I hold the cc1150 right next to the itho it still does not work.</p>
            </div>
          </div>      
        </article>
        <hr class="blog-seperator"/>
    </li>
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

</ol>
      </li>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
      <li>
        <article id="comment-52">
          <div class="d-flex">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/A588DF49CA47D22F71FC9C68D9C6EBDC?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Peter
                
              </div>
              <small>
                <a href="#comment-52" title="Link naar deze reactie">
                  <time>Wednesday 9 Mar 2016 om 10:27:57</time>
                  
                </a>
              </small>
              <p>Hi all,
Thanks for the great info. i am planning on this as well, ordered the cc1101 see howit works out.
I do have one remark for Jimmy, though it might have been obvious: the itho unit wanted me to active the remote after installation by pressing two diagonal buttons I think. I would say, after building, you need to do this as well. Could that be the reason for the unit not responding to the commands?</p>
            </div>
          </div>
          <hr class="blog-seperator"/>
        </article>
        <ol class="children">

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    <li>
      <article id="comment-54">
          <div class="d-flex flex-row">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/F0D6E096FD45271B1A8CE970F035B72B?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Jimmy reply to Peter
                
              </div>
              <small>
                <a href="#comment-54" title="Link naar deze reactie">
                  <time>Wednesday 9 Mar 2016 om 20:06:32</time>
                  
                </a>
              </small>
              <p>Hi Peter, because it dowsn&rsquo;t work to press two buttons on the arduino, there is a special function called itho.joinItho(); which is called at startup, during setup(). joinitho() should send the same code as when you press 2 buttons on the original remote (except offcourse as being a different remote).</p>
            </div>
          </div>      
        </article>
        <hr class="blog-seperator"/>
    </li>
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

</ol>
      </li>
      
    
      
      <li>
        <article id="comment-53">
          <div class="d-flex">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/F0D6E096FD45271B1A8CE970F035B72B?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Jimmy
                
              </div>
              <small>
                <a href="#comment-53" title="Link naar deze reactie">
                  <time>Wednesday 9 Mar 2016 om 13:19:28</time>
                  
                </a>
              </small>
              <p><p>Today a few other tests and results.
I have setup a tx/tx test between my 433MHz version cc1150 (tx) and 868MHz cc1101 (rx).
This code helped me: <a href="http://labalec.fr/erwan/?p=497">http://labalec.fr/erwan/?p=497</a>  (modified to use 868MHz)
It is possible to send/receive at a short distance of a few meters with no antenna on the cc1150 and a a antenna on the cc1101.
After searching, I also found that the antenna delivered with the cc1101 is not for 868MHz but 433MHz: <a href="https://github.com/OpenHR20/OpenHR20/wiki/2.1)--433-MHz-and-868-MHz--Antenna-Design-Examples">https://github.com/OpenHR20/OpenHR20/wiki/2.1)--433-MHz-and-868-MHz--Antenna-Design-Examples</a></p>

<p>I have now cut this antenna in 2 pieces, so I have a better antenna on the cc1101 and the cutted piece is just enough for an antenna on the cc1150.
As to be expected with the 433MHz filters on my cc1150 board, range is still limited to a few meters.</p>

<p>But at least I proved that it is possible to send data on 868MHz wih the cc1150/433MHz module.
As I said in previous comments, I held the cc1150 module against the itho fan module, so that must be good enough.</p>

<p>This only proved that my modules work with simple code, but still not sure if the itho code really sends and if so: what it sends.</p>
</p>
            </div>
          </div>
          <hr class="blog-seperator"/>
        </article>
        <ol class="children">

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    <li>
      <article id="comment-55">
          <div class="d-flex flex-row">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/7F2A9FD369018735070D34C0331FE9C5?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Rogier Reedijk reply to Jimmy
                
              </div>
              <small>
                <a href="#comment-55" title="Link naar deze reactie">
                  <time>Thursday 10 Mar 2016 om 22:15:42</time>
                  
                </a>
              </small>
              <p><p>Hi Jimmy,</p>

<p>Thanks for all your feedback until now! It is really motivating me to look at my code again.</p>

<p>I&rsquo;ve also found and used the same code you found. Sadly that code will not work with the Itho, because of 2 reasons:
1) the code uses the packet mode, instead of the serial-communication mode for the CC1101 and CC1150
2) each packet is surrounded by preamble and a sync-word. This is extra data that the Itho ventilation-unit isn&rsquo;t expecting.</p>

<p>If you read chapter 27 &ldquo;Asynchronous and Synchronous Serial Operation&rdquo; of the CC1101 datasheet, the different serail modes are explained. Within my code I&rsquo;m using the Synchronous Serial Operation with all the extra features DISABLED. That is the only way the Itho ventilationbox will accept data.</p>

<p>I&rsquo;m currently doing some research how hard it is going to be to implement a receive method that scans for the remote-id. I think I will be able to write one, but it&rsquo;s going to be even harder to test this method, since I currently don&rsquo;t have an Itho remote control. So I&rsquo;m probably going to do the same setup you created (an CC1150 transmitting Itho codes, and a CC1101 receiving/listing for the remote id). I&rsquo;ve I make any progress I will write a new blogpost or add it to the comments (and share my code on GitHub).</p>
</p>
            </div>
          </div>      
        </article>
        <hr class="blog-seperator"/>
    </li>
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

</ol>
      </li>
      
    
      
    
      
    
      
    
      
    
      
      <li>
        <article id="comment-58">
          <div class="d-flex">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/F0D6E096FD45271B1A8CE970F035B72B?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Jimmy
                
              </div>
              <small>
                <a href="#comment-58" title="Link naar deze reactie">
                  <time>Thursday 24 Mar 2016 om 15:49:02</time>
                  
                </a>
              </small>
              <p><p>Here&rsquo;s my latest &ldquo;news&rdquo;. Until now I was using a 5V Arduino and 5V/3.3V level shifters. Because I was not completely sure that I had never made any 5V/3.3V mistake, I ordered a new 3.3V Arduino Pro and a new CC1101 module. These are powered from my USB-FTDI Serial module which is also set to 3.3V. I checked Vcc, which is roughly 3.3V.  But sadly the itho still does not respond to the join() function.</p>

<p>But at least I now have a CC1101 with an Arduino Pro at 3.3V and a CC1101 with a &lsquo;normal&rsquo; Arduino and level shifters.
Those 2 sets could be helpful if anyone manages to create some listening/receiving code.</p>
</p>
            </div>
          </div>
          <hr class="blog-seperator"/>
        </article>
        <ol class="children">

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    <li>
      <article id="comment-64">
          <div class="d-flex flex-row">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/7F2A9FD369018735070D34C0331FE9C5?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Rogier Reedijk reply to Jimmy
                
              </div>
              <small>
                <a href="#comment-64" title="Link naar deze reactie">
                  <time>Monday 4 Apr 2016 om 18:32:49</time>
                  
                </a>
              </small>
              <p><p>Hi Jimmy,</p>

<p>Just a short update, I&rsquo;ve actually started working on the receiving code. But I haven&rsquo;t had enough time to finish the code, let alone test the code. I&rsquo;ve been very busy lately, so haven&rsquo;t had as much time for this hobby as I would like.
I&rsquo;m curious which CC1101 boards you actually have ordered? Do you have a link for me?
The board I recently ordered arrived, but has half plated holes and not the regular 0.1inch spacing between the holes, so connecting this board to a breadboard is going to be difficult (at least with my current soldering skills).</p>

<p>As soon as I&rsquo;ve had some more time to work on the code, I will let you know.</p>

<p>Regards, Rogier.</p>
</p>
            </div>
          </div>      
        </article>
        <hr class="blog-seperator"/>
    </li>
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

</ol>
      </li>
      
    
      
      <li>
        <article id="comment-59">
          <div class="d-flex">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/280BD2671A59E31527B50F2D55298CF0?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Ed van Rijn
                
              </div>
              <small>
                <a href="#comment-59" title="Link naar deze reactie">
                  <time>Sunday 3 Apr 2016 om 10:44:10</time>
                  
                </a>
              </small>
              <p><p>Hello Rogier,</p>

<p>This is a very interesting project.
I recently replaced my old ventilation unit by an Itho unit also and decided that i wanted to add my own controller with some
special functionality to control it as an add-on for the 2 remotes i have.
Without your project I might not have started because the protocol for the unit is not available but with your code i should be able to get
my own controller working.
As everybody found out already 868 MHz transmitters are not available, you could use a 433 MHz board but then you will have to replace the
inductors and capaciitors for the antenna circuit because the 433 MHz version will lower the output signal so much that the range will be
very small (if it works) . So i decided to make my own pcb based upon the demo boards of Texas Instruments.
I work as a hardware designer and i could import the Texas Instruments designs without a problem, then i added my own processor
and some other stuff i will need in the future.
The board design is in production now and i will receive the finished pcb&rsquo;s next week. I will order the parts also so i hope i can start assembling the boards soon and start with writing firmware when the processor part is running.
I posted the schematics and a picture of the pcb on github : <a href="https://github.com/EdvanRijn/Itho-controller">https://github.com/EdvanRijn/Itho-controller</a></p>

<p>I will let you know how it goes</p>

<p>regards,
Ed van Rijn</p>
</p>
            </div>
          </div>
          <hr class="blog-seperator"/>
        </article>
        <ol class="children">

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    <li>
      <article id="comment-62">
          <div class="d-flex flex-row">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/7F2A9FD369018735070D34C0331FE9C5?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Rogier Reedijk reply to Ed van Rijn
                
              </div>
              <small>
                <a href="#comment-62" title="Link naar deze reactie">
                  <time>Monday 4 Apr 2016 om 18:14:05</time>
                  
                </a>
              </small>
              <p><p>Hi Ed,</p>

<p>Thanks for sharing the pcb! I&rsquo;m very curious what your project will be doing besides controlling the Itho, because I see you added a microphone input?
My future goal is to make my own pcb as well. I didn&rsquo;t think about using the reference design from Texas Instruments, that&rsquo;s a very good tip!
The only thing stopping me from spinning up my own pcb right now is that all components are smd components. How are you going to mount the components when you get the boards? In the past I did some research on a reflow hot plate, but never got around to actually buying one.</p>

<p>Please do keep us posted on the progress you make. I will be following your GitHub repo.
If you have any questions, feel free to ask here or sent me an email at rogier(dot)reedijk(at)gmail(dot)com.</p>
</p>
            </div>
          </div>      
        </article>
        <hr class="blog-seperator"/>
    </li>
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

</ol>
      </li>
      
    
      
      <li>
        <article id="comment-60">
          <div class="d-flex">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/CF8A52B00AAAFF5039DFBB43F5D09462?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Klusjesman
                
              </div>
              <small>
                <a href="#comment-60" title="Link naar deze reactie">
                  <time>Monday 4 Apr 2016 om 14:23:13</time>
                  
                </a>
              </small>
              <p>I am working on some code for the CC1101 to be able to send and receive data. I have a few 868 prints. According the CC1101 datasheet a clock signal of 26MHz is required for the 868 range. The Itho print contains a 26MHz crystal. The only thing I don&rsquo;t know is where the ATMega169pv is getting its clock signal from since the max supported clock is 20MHz. Currently I am running at 14.7MHz. I will order some 26MHz crystals.</p>
            </div>
          </div>
          <hr class="blog-seperator"/>
        </article>
        <ol class="children">

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    <li>
      <article id="comment-61">
          <div class="d-flex flex-row">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/CF8A52B00AAAFF5039DFBB43F5D09462?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Klusjesman reply to Klusjesman
                
              </div>
              <small>
                <a href="#comment-61" title="Link naar deze reactie">
                  <time>Monday 4 Apr 2016 om 14:42:19</time>
                  
                </a>
              </small>
              <p>I just ordered some crystals and did a discovery afterwards. The 26MHz crystal is on board of the 868 print.</p>
            </div>
          </div>      
        </article>
        <hr class="blog-seperator"/>
    </li>
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

</ol>
      </li>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
      <li>
        <article id="comment-75">
          <div class="d-flex">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/F0D6E096FD45271B1A8CE970F035B72B?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Jimmy
                
              </div>
              <small>
                <a href="#comment-75" title="Link naar deze reactie">
                  <time>Tuesday 12 Apr 2016 om 17:05:03</time>
                  
                </a>
              </small>
              <p>It took some time, but now I have an RTL-SDR.
What I see is that the original RFT transmitter does a transmission at 868.something MHz.  I see thee short transmissions.
With the arduino/cc11xx, when I keep the antannas very close to each other, I only see 3 slight shifts in the noise over all the bandwidth.  When I &ldquo;tune&rdquo; to a totally different frequency (like 433MHz), I still see such a slight noise change.  What I suspect is that the cc11xx does transmit something 3 times, but at a totally wrong frequency.  Because I don&rsquo;t know how to figure out where or what it transmits, it still stucks me here.
(I am using an RTL-SDR stick with the R820T2 chip and the SDRSharp software)</p>
            </div>
          </div>
          <hr class="blog-seperator"/>
        </article>
        <ol class="children">

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    <li>
      <article id="comment-77">
          <div class="d-flex flex-row">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/F0D6E096FD45271B1A8CE970F035B72B?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Jimmy reply to Jimmy
                
              </div>
              <small>
                <a href="#comment-77" title="Link naar deze reactie">
                  <time>Wednesday 13 Apr 2016 om 17:23:26</time>
                  
                </a>
              </small>
              <p><p>With a bit of shame I must confess that I have now returned to the original library files and now I do see TX from the Arduino/cc1101 at 868.x MHz.
Probably next thing is to find out if it is possible to determine why the itho does not respond by doing something with what I can receive/capture?
We may need to compare the original rtf tx with the arduino tx.
Anyone has experience with handling the data that I can see now?  From SDRSharp or rtl_sdr.exe I can extract a WAV (or I/Q) file.</p>

<p>It could be just a calibration-issue with the rtl-sdr or the software, but I noticed that the RFT and cc1101 transmissions are at about 868.284671MHz, instead of 868.299865MHz.
They are both at (nearly) the same frequency, that won&rsquo;t be any problem.</p>

<p>Comparing the captured waves, I do see big simmilarities and small differences in the structure.
3 sessions, each consisting of 2 parts.
The first part on the RFT is 0.038mS, on the CC1101 about 0.034mS.  (may be measuring tollerance)
The 3 session together on the FRT 0.237mS, on the CC1101 only 0.188mS. Looks like a difference.
The first and second part seem to have a different encoding, but they are the same kind of encoding on RFT and CC1101.
The waves from the RFT are very clear, from the CC1101 they are somewhat distorted.
All above does not really look like the reason, it&rsquo;s only details.</p>

<p>If anyone is interested, I can post the 2 files somewhere. A simple wavetool like Audacity helped me looking at this detail.
(thanks to the guy from the earlier mentioned Zigbee me Decoding itho RF Protocol blog, who pointed at that tool)</p>

<p>I think I can see/recognise the bits as ones and zeroes in the waveforms.
But it is (nearly) impossible to compare all bits by hand.  :(
Anyone know some tool for that?</p>
</p>
            </div>
          </div>      
        </article>
        <hr class="blog-seperator"/>
    </li>
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

</ol>
      </li>
      
    
      
    
      
    
      
    
      
    
      
      <li>
        <article id="comment-80">
          <div class="d-flex">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/F0D6E096FD45271B1A8CE970F035B72B?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Jimmy
                
              </div>
              <small>
                <a href="#comment-80" title="Link naar deze reactie">
                  <time>Sunday 17 Apr 2016 om 18:40:21</time>
                  
                </a>
              </small>
              <p><p>Via my approach, receiving with the RTL-SDR, I have managed to read about all bits and bytes from both the original RFT and the Arduino/cc1101 now.
I have been able to get the ID from my RFT and changed the Arduino code to use that same ID. When I then compare both, they do have the same bits and bytes.  But still the itho fan does not respond to the arduino. So I searched for other differences.</p>

<p>For now I only focus on the &ldquo;low&rdquo; command.</p>

<p>1) As to be expected, there are differences at the points of the counters.
For instance: Halfway the const byte itho_RFT_message, the code reads:
    154, 86, //fixed value
    0, 0, 0,  // counter + commands
Some hard to follow function setCounter1Bytes shuffles bits in 0,0,0.
My RFT sends 85, 166, 102.  The arduino sent 85, 153, 102. But because these are part of a Counter, I think it is logical that they differ?</p>

<p>Another Counter:
The code says: const byte itho_RFT_low_command[] =    { 38, 89, 150, 170, 165, 101, 90, 150, 85, 149, 101, 89, 150,  85, 150,  6};
Then the code shuffles the last byte (6):
// correct the bit position of the last command byte
result[41] &lt;&lt;= 4;
Then it adds a counter that shuffles that byte again:
setCounter2Bytes(counter2, &amp;result[41], &amp;result[42], &amp;result[43]);
And then the footer is added: const byte itho_RFT_regular_footer[] = { 2, 172, 170, 170, 170, 170, 170, 7};
The RFT differs here in 3 bytes, starting from result[41], which I think is also because of the counters.</p>

<p>Then I discovered that my RFT sends a different itho_RF_low_command, so I changed it:
const byte itho_RF_low_command[] =    { 1,  84, 213, 85,  83,  51,  84};  // Last 2 bytes from my RFT are different</p>

<p>So looking after fixing the itho_RF_low_command, the only difference between the RFT and the Arduino is around the counters.
Because it still does not work, I&rsquo;m afraid it has to do with the counters, that are not &ldquo;in sync&rdquo; between the RFT and the Arduino. Am I possibly right?</p>
</p>
            </div>
          </div>
          <hr class="blog-seperator"/>
        </article>
        <ol class="children">

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    <li>
      <article id="comment-81">
          <div class="d-flex flex-row">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/CF8A52B00AAAFF5039DFBB43F5D09462?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Klusjesman reply to Jimmy
                
              </div>
              <small>
                <a href="#comment-81" title="Link naar deze reactie">
                  <time>Monday 18 Apr 2016 om 18:17:52</time>
                  
                </a>
              </small>
              <p><p>I think they are doing some trick with those counters. The remote and the receiver cannot be completely in sync in my opinion. Suppose you walk outside your home and press the remote a couple of times. When you return close to the receive and use the remote it still works. This should not be possible when the remote and receiver are completely synchronized using those counters. Because of the missing messages you would expect the remote to be out of sync.</p>

<p>It is nice the RTL-SDR is working. How does it handle the noise?</p>

<p>For me things are getting clear about the structure of the two RF messages. Since Itho is not using hardware packet handling the Atmega needs to track the packets itself. This is why the 170 values come into play. It is used to detect the beginning of the message and synchronize the timing to be able to peek at the next bits. Also I am starting to understand why async mode is used at the receiver side. With sync mode it is really difficult to receive only the first 32 bits without noise. During async receive the bits are high/low for times between 20us to 30us. This is why the bitshifts for the counters are required. With a long sequence of 0 or 1 it will be difficult to detect how many 0&rsquo;s or 1&rsquo;s there are. The max sequence for bits with the same value seems to be 2 bits. So the time between a rising and falling edge is always between 20 and 60us (there is one exception in the second message, but it is a fixed sequence).</p>

<p>The noise becomes clear when looking at message 1 in Salea analyzer. There are 8 clock pulses for 1 bit (because of the datarate difference between the two messages), But in the analyzer tool I do not see nice blocks of 8 bits. So using 8 peeks at the bits it needs to extract the intended meaning.</p>

<p>I am wondering if the noise is caused for a big part by the cheap CC1101 print. However, with other (different) cheap print the results are the same.</p>
</p>
            </div>
          </div>      
        </article>
        <hr class="blog-seperator"/>
    </li>
  

  

  

  

  

  

  
    <li>
      <article id="comment-87">
          <div class="d-flex flex-row">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/7F2A9FD369018735070D34C0331FE9C5?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Rogier Reedijk reply to Jimmy
                
              </div>
              <small>
                <a href="#comment-87" title="Link naar deze reactie">
                  <time>Tuesday 19 Apr 2016 om 20:54:49</time>
                  
                </a>
              </small>
              <p><p>Hey Jimmy!</p>

<p>It is logical that the counters differ between the Arduino and the original Itho remote. My code just starts the counter at an arbitrary number and decreases the counter number on every message.
As far as I&rsquo;ve seen the Itho box isn&rsquo;t expecting numbers to be a nice lineair set. The only restriction I&rsquo;ve found is that sending the exact same message (with the same counter values) doesn&rsquo;t seem to work.</p>

<p>Looking back at my own code, I see that the low-command for both the remotes I tested with (ITHO_REMOTE1 and the ELSE block) are different. So I&rsquo;m not really surprised that the low-command from your remote is also different. The question remains what those last <sup>2</sup>&frasl;<sub>3</sub> bytes mean. It could be yet another identifier for the remote&hellip;
On the other hand, my remotes should actually work with your ventilation box (as long as the remote is joined). So as long as the message contains the values the Itho box is expecting, it shouldn&rsquo;t matter which identifier the Arduino uses.</p>

<p>It sound like you are very close to getting it working yourself! It sounds like there is just a very small difference in the message that you haven&rsquo;t found yet. Keep up the good work and do let us know if you make any progress.</p>

<p>As soon as I find the time I will continue working on my own receive code and upload it to GitHub. And then I should buy an actual Itho ventilation box so I can actually test my code again in my new house. ;-)</p>
</p>
            </div>
          </div>      
        </article>
        <hr class="blog-seperator"/>
    </li>
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

</ol>
      </li>
      
    
      
    
      
      <li>
        <article id="comment-82">
          <div class="d-flex">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/F0D6E096FD45271B1A8CE970F035B72B?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Jimmy
                
              </div>
              <small>
                <a href="#comment-82" title="Link naar deze reactie">
                  <time>Tuesday 19 Apr 2016 om 06:37:46</time>
                  
                </a>
              </small>
              <p><p>There&rsquo;s not much noise and not much difference between the RFT and CC1101 signals.
Sometime I seem to miss a bit (partial), but I think that is not because the RFT/CC1101 but because I have to use the RTL-SDR on the edge of speed.
E.g. I need to use a sample rate of 3.2MSPS, while documentation says 2.56 is max for most environments.</p>

<p>For now I am manually looking at the captured signal and finding the 1&rsquo;s and 0&rsquo;s.
(which is difficult when sometimes losing a bit)
So for me the 170&rsquo;s are also very handy to see if I am still &ldquo;reading in sync&rdquo;.
When placing multiple captured waves next to each other, it&rsquo;s possible to find the differences.
If I find such a difference I need to find the actual position in the bitstream compared to the Arduino code, to figure out what the real difference is.
That way I found my own RFT ID. (which I need to double-check because it still doesn&rsquo;t work)</p>

<p>You are right that the counters cannot be too exact.  On the other hand, those are the only difference I can find now.
If I have more time to spend, I could try to capture and decode one packet from the RFT, try to recalculate the counters and send that from the Arduino/cc1101.</p>

<p>I am now comparing my RFT low/mid/high/timer codes, to see what my RFT actually sends.</p>
</p>
            </div>
          </div>
          <hr class="blog-seperator"/>
        </article>
        <ol class="children">

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

</ol>
      </li>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
      <li>
        <article id="comment-92">
          <div class="d-flex">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/CF8A52B00AAAFF5039DFBB43F5D09462?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Klusjesman
                
              </div>
              <small>
                <a href="#comment-92" title="Link naar deze reactie">
                  <time>Friday 22 Apr 2016 om 15:40:50</time>
                  
                </a>
              </small>
              <p><p>I am finished with my code to parse the incoming messages, it is on github. At the same time I made functions which are doing the opposite for sending.</p>

<p>I only have 1 counter in my code. It is a byte (0-255). It is just incremented on every button press. All 6 counter bytes are derived from this single counter. I have tested the code using a database containing thousands of RF message data and it all works fine.</p>

<p>There are the following commands:
- join, leave
- low, medium, full
- timer1, timer2, timer3 (when you press the timer button 3 times quickly it will send a message on every press = timer1, timer2 and timer3 command)</p>

<p>The code contains a function to get the counter value out of the first 3 counter bytes in the message. And there are functions to generate the 6 bytes out of the counter value for sending.</p>

<p>I guess the unknown bytes which are left are all for the device id.</p>
</p>
            </div>
          </div>
          <hr class="blog-seperator"/>
        </article>
        <ol class="children">

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    <li>
      <article id="comment-93">
          <div class="d-flex flex-row">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/CF8A52B00AAAFF5039DFBB43F5D09462?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Klusjesman reply to Klusjesman
                
              </div>
              <small>
                <a href="#comment-93" title="Link naar deze reactie">
                  <time>Sunday 1 May 2016 om 16:18:12</time>
                  
                </a>
              </small>
              <p><p>I am able to control my ventilation using the CC1101 without any problems. The Itho remote and my own remote are working together at the same time, using the same id&rsquo;s. At the moment my leave implementation does not work. Join and leave have different sized messages, also compared to the normal commands. I am using FIFO for sending and receiving and this is working fine. I did not test the join command yet. When the join and leave commands are working everybody should be able to control their Itho ventilation using my code.</p>

<p>It is not possible to just put your own device id into my code because it will not work without making some changes to the calculations of the counter bytes.</p>
</p>
            </div>
          </div>      
        </article>
        <hr class="blog-seperator"/>
    </li>
  

  
    <li>
      <article id="comment-94">
          <div class="d-flex flex-row">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/CF8A52B00AAAFF5039DFBB43F5D09462?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Klusjesman reply to Klusjesman
                
              </div>
              <small>
                <a href="#comment-94" title="Link naar deze reactie">
                  <time>Monday 2 May 2016 om 19:04:25</time>
                  
                </a>
              </small>
              <p><p>The join and leave commands are also working properly now. So everybody should be able to join the atmega to an Itho Eco Fan RFT and have full control.</p>

<p>The only thing I will spend some time on is to simplify the code and calculations for the counter. This will save some bytes from memory.</p>
</p>
            </div>
          </div>      
        </article>
        <hr class="blog-seperator"/>
    </li>
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

</ol>
      </li>
      
    
      
    
      
    
      
    
      
      <li>
        <article id="comment-96">
          <div class="d-flex">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/F0D6E096FD45271B1A8CE970F035B72B?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Jimmy
                
              </div>
              <small>
                <a href="#comment-96" title="Link naar deze reactie">
                  <time>Wednesday 4 May 2016 om 19:29:52</time>
                  
                </a>
              </small>
              <p><p>Since klusjesman was making great progress, I decided to follow his developments closer ad implement all his changes to Rogier&rsquo;s code.  I tested his findings on my itho/rft and we discovered many new things. For instance, with my RTL-SDR I saw that the join (and leave) command was much larger, and that the counters from klusjesman did not match the counters from my RFT.  With those new findings and much of his research, Klusjesman got closer to a complete solution, so I completely switched over to his code.
To use his code, I needed to change things to make is work with the Arduino IDE.  (Especially SPI was different, so for a lot of SPI related functions I took parts from Rogier and other internet resources and put those into the code from Klusjesman)</p>

<p>To make the code from Klusjesman compatible with my own RFT, I had to change some things as expected, like the Device ID and the ComandBytes. But then it turned out that there are also differences in the counter-bytes, like some parts are shifted and some bytes are just different or in a different order.  I managed to fix those too, so at last my Arduino+CC1101 worked the same as my RFT module.</p>

<p>Next step for me was to make it work on an ESP8266 module instead of an Arduino, which involved a slight SPI change and inserting a few &ldquo;yield()&rdquo; codes to prevent the ESP8266 watchdog to kick in.</p>

<p>Today I took the last step important step, I took the RFT device ID, command-codes, and the counter-calculations from Klusjesman. After turning the Itho fan off/on, it accepted the Join command!  So now we have proven that we can use his code without having to figure out one&rsquo;s own device-id etcetera.
(which might only become a problem if your neighbor also has an itho and starts to use this code&hellip;)</p>
</p>
            </div>
          </div>
          <hr class="blog-seperator"/>
        </article>
        <ol class="children">

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    <li>
      <article id="comment-97">
          <div class="d-flex flex-row">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/BD446D44408677D08C5A5F907D71B8EE?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                JFdB reply to Jimmy
                
              </div>
              <small>
                <a href="#comment-97" title="Link naar deze reactie">
                  <time>Wednesday 11 May 2016 om 07:54:21</time>
                  
                </a>
              </small>
              <p>Dear Jimmy,
Can you post the changes that you made to the code of Klusjesman? I downloaded his code, and I have great difficulty to incorporate the assembler code (the .S file). The arduino compiler is complaining a lot about this file. And I have not even encountered the SPI problems that you mention above, so I do not know what awaits me.</p>
            </div>
          </div>      
        </article>
        <hr class="blog-seperator"/>
    </li>
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

</ol>
      </li>
      
    
      
    
      
    
      
    
      
    
      
    
      
      <li>
        <article id="comment-102">
          <div class="d-flex">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/BD446D44408677D08C5A5F907D71B8EE?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                JFdB
                
              </div>
              <small>
                <a href="#comment-102" title="Link naar deze reactie">
                  <time>Thursday 12 May 2016 om 17:13:40</time>
                  
                </a>
              </small>
              <p><p>Dear Klusjesman,
After checking with Rogier&rsquo;s description  I can see that the &ldquo;wrong&rdquo; message bytes (nearly) all relate to the device ID or the checksum.
I understand I can remove these print statements and all will work fine, but now that I have come this far I would like to understand it better (until I get bored and I just want it to work)
What was not clear to me is what happens if I change the device ID in your code, will the calculation of checksum and other bytes become incorrect?
Does your code only work with the hard coded device ID? (I think so but I am not sure)</p>

<p>I understand I can extract my device ID from the message dump provided by your program, but can I reconstruct the full message needed for this device ID (i.e., is there a sound algorithm to do this), or do I need to solve my own puzzle (pressing all the buttons and recording the messages) like you and Rogier apparently did.</p>

<p>In my previous post I could not print the angled brackets in the following statement:</p>

<p>&ldquo;except for the BBuart library, that was included with
#include (angled bracket open) BBuart.h (angled bracket close)
(note the angled brackets instead of the quotes)&rdquo;</p>
</p>
            </div>
          </div>
          <hr class="blog-seperator"/>
        </article>
        <ol class="children">

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    <li>
      <article id="comment-103">
          <div class="d-flex flex-row">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/CF8A52B00AAAFF5039DFBB43F5D09462?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Klusjesman reply to JFdB
                
              </div>
              <small>
                <a href="#comment-103" title="Link naar deze reactie">
                  <time>Thursday 12 May 2016 om 17:28:17</time>
                  
                </a>
              </small>
              <p><p>A few bytes will be incorrect when you are gonna use your own device id. Jimmy did some work on this already for his remote. You will need to press buttons to find out the relation between the counter bytes. I believe the only changes are related with the starting offset within the arrays. But it should not be that hard since you have a nice log of all bytes ;),  It is a lot of work since one cycle of the counter is 256 button presses. Also you have to be careful with the button. After thousands of button presses it ruins the buttons. Especially when you want to test button combinations.</p>

<p>I am busy with work the next months so I am not working on it anymore. For me the code is good enough, for now. It works and there is a possibility we never find a algorithm which works for all device id&rsquo;s. There could be a chance the counter, device id or some other variable which influences the calculation is stored in EEPROM on the remote.</p>
</p>
            </div>
          </div>      
        </article>
        <hr class="blog-seperator"/>
    </li>
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

</ol>
      </li>
      
    
      
    
      
    
      
    
      
    
      
      <li>
        <article id="comment-107">
          <div class="d-flex">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/7F2A9FD369018735070D34C0331FE9C5?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Rogier Reedijk
                
              </div>
              <small>
                <a href="#comment-107" title="Link naar deze reactie">
                  <time>Friday 13 May 2016 om 07:06:11</time>
                  
                </a>
              </small>
              <p><p>JFDB,
I&rsquo;ve juist trad through the datasheet and on page 56, chapter 20 called &ldquo;Data FIFO&rdquo;, there is a table that specifies when a buffer under flow will occur. You are right that it&rsquo;s related to the message being bigger than 64 bytes. Looking at the code Klusjesman has written, the initSendMessage2 method should be changed, because it sets the PKT_LENGTH to an invalid value (cannot be higher than 64 bytes). Also in the SendData method there should be a register write that sets the FIFO_THR to the remain bytes (most likely 72 - 64 = 8) to prevent the buffer under flow message.
If I read the datasheet correctly, in the current implementation the last 8 bytes won&rsquo;t be transferred because of the buffer under flow (ea the buffer isn&rsquo;t filled to the fixed packet length value, and thus cannot start transmitting).</p>

<p>Sadly I still haven&rsquo;t had the time to test out the code Klusjesman wrote, but with these changes it should work. When I find the time I will try to update my GitHub repo and also submit a Pull Request to Klusjesman&rsquo;s repo to address this problem. If anyone has more time to do this, feel free to post the necessary changes on this form or sent them to me or Klusjesman!</p>
</p>
            </div>
          </div>
          <hr class="blog-seperator"/>
        </article>
        <ol class="children">

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    <li>
      <article id="comment-108">
          <div class="d-flex flex-row">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/CF8A52B00AAAFF5039DFBB43F5D09462?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Klusjesman reply to Rogier Reedijk
                
              </div>
              <small>
                <a href="#comment-108" title="Link naar deze reactie">
                  <time>Friday 13 May 2016 om 16:16:26</time>
                  
                </a>
              </small>
              <p><p>The PKT_LEN is not the problem because packages bigger than 64 bytes are allowed. You just have to fill the FIFO with new bytes while it is transmitting. In the code I am putting new data in the buffer when there is free space for 2 bytes. Using the FIFO it is possible to send and receive really big messages.</p>

<p>If speed is a concern then you probably need to use an interrupt on GDO as indicator when you can put more bytes in the FIFO. But since the code is working on my ATMega328P I did not spend time on this. Also the current implementation is way easier.</p>

<p>I guess you moved to Arduino SPI and are using Arduino libs? First thing I would do is strip out the Arduino functions because they have extra overhead compared to using the ATMega registers directly.</p>

<p>I remember Jimmy having similar problems in the beginning but I cannot remember what the exact cause was. I believe it was something related with the implementation of the writeBurst SPI function.</p>
</p>
            </div>
          </div>      
        </article>
        <hr class="blog-seperator"/>
    </li>
  

  

  
    <li>
      <article id="comment-110">
          <div class="d-flex flex-row">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/BD446D44408677D08C5A5F907D71B8EE?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                JFdB reply to Rogier Reedijk
                
              </div>
              <small>
                <a href="#comment-110" title="Link naar deze reactie">
                  <time>Friday 13 May 2016 om 18:11:47</time>
                  
                </a>
              </small>
              <p><p>Dear Rogier and Klusjesman,
 I figured out the problem. When the send message is larger than 64 (In klusjesman code actually 61) bytes, the send command routine first sends 61 bytes in burst mode and then starts checking the TX_BUFFER to see if the additional bytes can be send.
However, due to a hardware bug, reading of some registers gives erroneous results, this was solved (as recommended by the CC1101 errata sheet) by reading the registers until two consecutive reads give the same results (readRegisterWithSyncProblem). However, this fails massively for a register that is continuously updated (like the number of bytes in the TX_BUFFER during sending). Thus readRegisterWithSyncProblem for the TX_BUFFER only returns when the buffer is empty, then two consequtive reads will give the same results. That is too late and leads to a TXFIFO_UNDERFLOW condition! The solution is to simply read the register just once, accepting that the value might be incorrect, but at least the TXFIFO_UNDERFLOW condition does not occur.
Therefore the following statement:</p>

<p>while ((txStatus = (readRegisterWithSyncProblem(CC1101_TXBYTES, CC1101_STATUS_REGISTER) &amp; CC1101_BITS_RX_BYTES_IN_FIFO)) &gt; (CC1101_DATA_LEN - 2))</p>

<p>Was replaced by:</p>

<p>while ((txStatus = (readRegister(CC1101_TXBYTES | CC1101_STATUS_REGISTER) &amp; CC1101_BITS_RX_BYTES_IN_FIFO)) &gt; (CC1101_DATA_LEN - 2));</p>

<p>(Note the &ldquo;|&rdquo; in readRegister)</p>

<p>Klusjesman: I believe this should also be fixed in your github post in the file CC1101.cpp</p>

<p>I have successfully joined  the Itho fan, and can control the speed from the arduino program. Success!!!</p>

<p>I would like to post the arduino code on github, but I have never done that before. Can I fork from Klusjesman or Rogier your code?
Klusjesman seems most appropriate, I have only made a few changes to his code.
Both of you, again awesome job figuring out the Itho messages and writing the code to program the CC1101 module, thanks so much</p>
</p>
            </div>
          </div>      
        </article>
        <hr class="blog-seperator"/>
    </li>
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

</ol>
      </li>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
      <li>
        <article id="comment-116">
          <div class="d-flex">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/BD446D44408677D08C5A5F907D71B8EE?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                JFdB
                
              </div>
              <small>
                <a href="#comment-116" title="Link naar deze reactie">
                  <time>Friday 13 May 2016 om 21:17:52</time>
                  
                </a>
              </small>
              <p>What I don not like about the fix is that it is not robust. I tried to think through the consequences of the
txStatus = (readRegister(CC1101_TXBYTES | CC1101_STATUS_REGISTER) &amp; CC1101_BITS_RX_BYTES_IN_FIFO
reporting the wrong number of bytes in the TX_buffer. If it reports more bytes than there actually are -&gt; no problem, on the next loop it will be most likely correct.
If the number of bytes in the TX_buffer is reported smaller than it actually is, then the program thinks it can send more bytes into the buffer than there is actually space and data in the FIFO will be overwritten.
I tried to create this situation to see what kind of error would be reported, but I could not write data fast enough into the buffer to create an overwrite.
I was expecting that a TXFIFO_UNDERFLOW would be created, because due to the overwrite, less data is written to the buffer than needs to be send.
This error could be caught by the program an handled to make the program robust.</p>
            </div>
          </div>
          <hr class="blog-seperator"/>
        </article>
        <ol class="children">

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    <li>
      <article id="comment-117">
          <div class="d-flex flex-row">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/CF8A52B00AAAFF5039DFBB43F5D09462?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Klusjesman reply to JFdB
                
              </div>
              <small>
                <a href="#comment-117" title="Link naar deze reactie">
                  <time>Saturday 14 May 2016 om 07:54:29</time>
                  
                </a>
              </small>
              <p><p>I am running with a 14.7456MHz crystal. The SPI connection is set up at a low speed (SPI::Init). You can try to increase the SPI speed to see if it solves the problem.</p>

<p>&ldquo;What I don not like about the fix is that it is not robust.&rdquo; It is not really related with the fix but with the way the send function is working for messages bigger than 64 bytes. The status is already retrieved so it would be easy to add some extra checks to check for overflow/underflow. There can also be a short timeout on the function.</p>
</p>
            </div>
          </div>      
        </article>
        <hr class="blog-seperator"/>
    </li>
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

</ol>
      </li>
      
    
      
    
      
      <li>
        <article id="comment-118">
          <div class="d-flex">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/BD446D44408677D08C5A5F907D71B8EE?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                JFdB
                
              </div>
              <small>
                <a href="#comment-118" title="Link naar deze reactie">
                  <time>Saturday 14 May 2016 om 14:09:47</time>
                  
                </a>
              </small>
              <p>I decided not to play with the play with the SPI speed (otherwise it becomes hardware dependent).
I implemented a readregister function that returns the median of 3 values.
readRegisterMedian3
This should reduce significantly the probability that incorrect values are read from a register, and at the same time should be (somewhat) save for reading e.g., the TX_BUFFER register that is continuously updated. It should be tolerant to reading no more than one incorrect value out of three.
Updated the sendData subroutine with this change, and added jumping out of the subroutine in case of a TXFIFO_UNDERFLOW.
I put a pull request to Klusjesman.
<a href="https://github.com/Klusjesman/IthoEcoFanRFT/pull/2">https://github.com/Klusjesman/IthoEcoFanRFT/pull/2</a>
I created a repository for the Arduino code:
<a href="https://github.com/JFdeB/ArduinoIthoEcoFanRFT">https://github.com/JFdeB/ArduinoIthoEcoFanRFT</a>
:)</p>
            </div>
          </div>
          <hr class="blog-seperator"/>
        </article>
        <ol class="children">

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    <li>
      <article id="comment-119">
          <div class="d-flex flex-row">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/BD446D44408677D08C5A5F907D71B8EE?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                JFdB reply to JFdB
                
              </div>
              <small>
                <a href="#comment-119" title="Link naar deze reactie">
                  <time>Monday 16 May 2016 om 23:54:40</time>
                  
                </a>
              </small>
              <p><p>Dear Klusjesman,
What still puzzles me is your BBuart.S file, specifically the port for serial communication. For the arduino project I had to make the following changes:
In the BBuart.S file the port needed to be changed from PortC to PortD (serial port on the Pro Mini is on portD)
The UART_TX needed to be changed from 0 to 1
The UART_RX needed to be changed from 1 to 0
The changed three lines in BBuart.S are below:</p>

<p>#define UART_Port (PORTD-0x20)
#define UART_Tx 1
#define UART_Rx 0</p>

<p>We both use the ATMega328P chip, in the data sheet the USART is given as:
PD1: TXD (USART Output Pin) PCINT17 (Pin Change Interrupt 17)
PD0: RXD (USART Input Pin) PCINT16 (Pin Change Interrupt 16)</p>

<p>Are you sure that define UART_Port (PORTC-0x20)  is correct in your code, shouldn&rsquo;t it be PORTD?
I am happy to change it on github, but if you tested it with PORTC i will leave it alone.</p>
</p>
            </div>
          </div>      
        </article>
        <hr class="blog-seperator"/>
    </li>
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

</ol>
      </li>
      
    
      
    
      
    
      
      <li>
        <article id="comment-121">
          <div class="d-flex">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/F0D6E096FD45271B1A8CE970F035B72B?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Jimmy
                
              </div>
              <small>
                <a href="#comment-121" title="Link naar deze reactie">
                  <time>Wednesday 18 May 2016 om 10:13:47</time>
                  
                </a>
              </small>
              <p><p>Hi all,  sorry for the silence. Before posting my Arduino (and ESP8266) code, I want to do a big clean-up.
What I want to do is to create a fork of Klusjesman&rsquo;s code and then put my modifications onto that (on my fork).
But now I see that JFdeB is also making changes to klusjesman&rsquo;s code and I am not sure if I want/need those in my Arduino/ESP8266 version.</p>

<p>So @Klusjesman, can you confirm that you are confident with JFdeB&rsquo;s changes, and should I take those into my code too?</p>
</p>
            </div>
          </div>
          <hr class="blog-seperator"/>
        </article>
        <ol class="children">

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    <li>
      <article id="comment-124">
          <div class="d-flex flex-row">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/CF8A52B00AAAFF5039DFBB43F5D09462?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Klusjesman reply to Jimmy
                
              </div>
              <small>
                <a href="#comment-124" title="Link naar deze reactie">
                  <time>Wednesday 18 May 2016 om 16:40:15</time>
                  
                </a>
              </small>
              <p><p>Jimmy,</p>

<p>For my own project I will use my original readRegisterWithSyncProblem since this is what TI is recommending and is also working nicely on my Atmega. When the readRegisterWithSyncProblem function is giving problems it means you are running into the SPI sync bug a lot (=unreliable read result). I rather like solving the real problem instead of implementing a work around.</p>

<p>I will only include the underflow check. But there are some other checks I will add (when I have time). There is one more bug in the CC1101 which needs to be addressed in the code. Also I will increase the SPI speed because it is running at the lowest speed. At least the speed can be doubled.</p>
</p>
            </div>
          </div>      
        </article>
        <hr class="blog-seperator"/>
    </li>
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

</ol>
      </li>
      
    
      
      <li>
        <article id="comment-122">
          <div class="d-flex">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/F0D6E096FD45271B1A8CE970F035B72B?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Jimmy
                
              </div>
              <small>
                <a href="#comment-122" title="Link naar deze reactie">
                  <time>Wednesday 18 May 2016 om 13:54:39</time>
                  
                </a>
              </small>
              <p>Not sure if I did it all properly, but my new code is on github too.
I decided to make a clone instead of a fork, because it&rsquo;s useless to bother the original git from klusjesman with what I modify for Arduino/ESP8266.
It can be found here: <a href="https://github.com/supersjimmie/IthoEcoFanRFT">https://github.com/supersjimmie/IthoEcoFanRFT</a></p>
            </div>
          </div>
          <hr class="blog-seperator"/>
        </article>
        <ol class="children">

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

</ol>
      </li>
      
    
      
      <li>
        <article id="comment-123">
          <div class="d-flex">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/35CCA066EC954EABD9DFF3AC3EC6154A?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                André
                
              </div>
              <small>
                <a href="#comment-123" title="Link naar deze reactie">
                  <time>Wednesday 18 May 2016 om 16:22:11</time>
                  
                </a>
              </small>
              <p><p>Why are you using seperate rf and controller boards?
There are Jeelabs usb sticks available that are all in one!
<a href="http://www.digitalsmarties.net/products/jeelink">http://www.digitalsmarties.net/products/jeelink</a></p>

<p>I have both types, the Classic and the V3c with RFM12b or RFM69CW 868MHz transceivers and an AT328 on board.
These sticks are handy when using a Raspberry Pi or even a Windows pc.
Is it possible for someone to port the code so that it can work with a Rpi?
The only thing needed is serial comms with the usb port as far as I understand.</p>
</p>
            </div>
          </div>
          <hr class="blog-seperator"/>
        </article>
        <ol class="children">

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    <li>
      <article id="comment-127">
          <div class="d-flex flex-row">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/F0D6E096FD45271B1A8CE970F035B72B?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Jimmy reply to André
                
              </div>
              <small>
                <a href="#comment-127" title="Link naar deze reactie">
                  <time>Thursday 19 May 2016 om 08:17:13</time>
                  
                </a>
              </small>
              <p><p>Hi André,  an Arduino or ESP8266 together with a CC1101 cost about 7 euros (perhaps +3 euros, if the Arduino/ESP doesn&rsquo;t have serial yet), while the jeelink costs 32,50 euro.
Beside the price, how would you add things like a few buttons and a CO2 sensor to it?</p>

<p>If you choose to use an RPi with a CC1101, it should be &ldquo;relatively easy&rdquo; to port the code, since rPI also supports SPI:
<a href="https://cdn.sparkfun.com/assets/learn_tutorials/4/4/9/pin-labels-on-pi-ver2.png">https://cdn.sparkfun.com/assets/learn_tutorials/4/4/9/pin-labels-on-pi-ver2.png</a>
AFAIK the RPi is also 3.3V which makes connecting the CC1101 to the RPi easy too.
All you will have to do is write RPi code that does the same as the code from Rogier and Klusjesman&hellip;</p>

<p>If you want to use a different radio-chip like that jeelink&rsquo;s RFM69CW, you will need to figure out how to make that chip send the same bits with the same speed at the same frequency with the same modulation as we do now with the CC1101.  Since it is &lsquo;exactly known&rsquo; what is sent, you can to tell the chip to do the same.</p>

<p>Why don&rsquo;t you just buy your own Arduino+CC1101 for a few euros?  :)</p>
</p>
            </div>
          </div>      
        </article>
        <hr class="blog-seperator"/>
    </li>
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

</ol>
      </li>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
      <li>
        <article id="comment-131">
          <div class="d-flex">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/BD446D44408677D08C5A5F907D71B8EE?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                JFdB
                
              </div>
              <small>
                <a href="#comment-131" title="Link naar deze reactie">
                  <time>Saturday 4 Jun 2016 om 16:39:20</time>
                  
                </a>
              </small>
              <p>Hi Rogier,
I am very far along reverse engineering the ELRO alarm system HA68.
I can read the messages from the door sensors, the smoke alarm, the entry keys and the motion sensors. Was quite some work figuring out the CC1101 settings to intercept the messages.
Any interest in this info on maybe a separate project page?</p>
            </div>
          </div>
          <hr class="blog-seperator"/>
        </article>
        <ol class="children">

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    <li>
      <article id="comment-132">
          <div class="d-flex flex-row">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/7F2A9FD369018735070D34C0331FE9C5?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Rogier Reedijk reply to JFdB
                
              </div>
              <small>
                <a href="#comment-132" title="Link naar deze reactie">
                  <time>Sunday 5 Jun 2016 om 18:34:51</time>
                  
                </a>
              </small>
              <p><p>Hey JFDB,</p>

<p>Sounds like a lot of work! Off course I&rsquo;m interested in the code. But don&rsquo;t you want to put the code on your own blog? (easily created for free at www.WordPress.com for instance) Or else create a project page on www.Hackaday.io? This way more people will find your project and code.</p>
</p>
            </div>
          </div>      
        </article>
        <hr class="blog-seperator"/>
    </li>
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

</ol>
      </li>
      
    
      
    
      
    
      
    
      
      <li>
        <article id="comment-135">
          <div class="d-flex">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/61BFCE79AB682EFE355E751F0DC53341?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Leon Arkesteijn
                
              </div>
              <small>
                <a href="#comment-135" title="Link naar deze reactie">
                  <time>Sunday 11 Sep 2016 om 19:48:08</time>
                  
                </a>
              </small>
              <p><p>Hi Jimmy,</p>

<p>I started your code as recommended by JFdB.</p>

<p>got all the parts, soldered it together and loader the program, so up and running. However I&rsquo;m not so experienced in coding and now have a question. In the code of Rogier it works with 4 buttons, however in your code I do not see the buttons in the code. Is this with a reason, do I need to add this code myself or do I miss something?</p>
</p>
            </div>
          </div>
          <hr class="blog-seperator"/>
        </article>
        <ol class="children">

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    <li>
      <article id="comment-136">
          <div class="d-flex flex-row">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/F0D6E096FD45271B1A8CE970F035B72B?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Jimmy reply to Leon Arkesteijn
                
              </div>
              <small>
                <a href="#comment-136" title="Link naar deze reactie">
                  <time>Monday 19 Sep 2016 om 13:36:58</time>
                  
                </a>
              </small>
              <p><p>My code is not excluding buttons, you can just use any way you want to send any signal.
If you want to use buttons, you can do something like in Rogier&rsquo;s code.
If you want the speed to be controlled by any sensor, you can use any code to read the sensor and send a command depending on the reading of the sensor.</p>

<p>For example, you are using an analog CO2 sensor.
When the sensor gives an analogRead value of 200 you want to send the Full.
Then you can add code to your loop like:
int a = analogRead(A0);
if (a99) &amp;&amp; (a200) sendFullSpeed();</p>

<p>Just be creative.<br />
(and make sure you are not sending a command every time your loop() runs, otherwise it will send almost continously)</p>
</p>
            </div>
          </div>      
        </article>
        <hr class="blog-seperator"/>
    </li>
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

</ol>
      </li>
      
    
      
    
      
    
      
      <li>
        <article id="comment-138">
          <div class="d-flex">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/BD446D44408677D08C5A5F907D71B8EE?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                JFdB
                
              </div>
              <small>
                <a href="#comment-138" title="Link naar deze reactie">
                  <time>Monday 19 Sep 2016 om 16:08:23</time>
                  
                </a>
              </small>
              <p>Hi Leon,
Jimmys github code is simple to understand.
The setup loop tries to register the arduino device as a remote with the fan.
The loop loop just monitors communication to the tho fan.
If you want it to send a commend, just insert the code
 sendFullSpeed();
at the end of the loop() loop
But since the arduino runs this loop multiple times per second, it is better to include a delay statement, like
 sendFullSpeed();
delay(100000); //this delays by 100 seconds
All is functional when your fan speeds up to full speed when you run this code</p>
            </div>
          </div>
          <hr class="blog-seperator"/>
        </article>
        <ol class="children">

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    <li>
      <article id="comment-139">
          <div class="d-flex flex-row">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/61BFCE79AB682EFE355E751F0DC53341?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Leon Arkesteijn reply to JFdB
                
              </div>
              <small>
                <a href="#comment-139" title="Link naar deze reactie">
                  <time>Monday 19 Sep 2016 om 18:48:51</time>
                  
                </a>
              </small>
              <p><p>Thanks (both) for your replies,</p>

<p>I indeed got it working by adding some code. I tried to make this a &ldquo;mysensor&rdquo; node to easily integrate into my domoticz. but unfortunately I was not successful in having two SPI devices combined (CC1011 and NRF24L01). therefore I now use two arduino&rsquo;s that communicate with some IO pin&rsquo;s (not the most elegant way, but it works)  However I wonder that the while loop does, you say it monitors the communication, but I thought  the receiving part was not operational? or should that work as well. (the pins are not connected now I think?)</p>
</p>
            </div>
          </div>      
        </article>
        <hr class="blog-seperator"/>
    </li>
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

</ol>
      </li>
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
      <li>
        <article id="comment-146">
          <div class="d-flex">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/61BFCE79AB682EFE355E751F0DC53341?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Leon Arkesteijn
                
              </div>
              <small>
                <a href="#comment-146" title="Link naar deze reactie">
                  <time>Wednesday 21 Sep 2016 om 21:47:56</time>
                  
                </a>
              </small>
              <p><p>Jimmy,</p>

<p>quickly added some debug code, but nothing came in at all. My transmitter is about 6m distance in clear sight. I will look into this further when i have my new hardware in.</p>
</p>
            </div>
          </div>
          <hr class="blog-seperator"/>
        </article>
        <ol class="children">

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    <li>
      <article id="comment-147">
          <div class="d-flex flex-row">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/F0D6E096FD45271B1A8CE970F035B72B?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Jimmy reply to Leon Arkesteijn
                
              </div>
              <small>
                <a href="#comment-147" title="Link naar deze reactie">
                  <time>Thursday 22 Sep 2016 om 07:44:46</time>
                  
                </a>
              </small>
              <p>Leon, did you double check the cabling? Like I said yesterday, there was a mistake in my previous descriptions&hellip;
Also please do a test within a few cm range, just to be very sure it&rsquo;s not an antenna problem.</p>
            </div>
          </div>      
        </article>
        <hr class="blog-seperator"/>
    </li>
  

  

  

  

  

  

  

  

  

  

  

  

</ol>
      </li>
      
    
      
    
      
      <li>
        <article id="comment-148">
          <div class="d-flex">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/61BFCE79AB682EFE355E751F0DC53341?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Leon Arkesteijn
                
              </div>
              <small>
                <a href="#comment-148" title="Link naar deze reactie">
                  <time>Thursday 29 Sep 2016 om 19:06:22</time>
                  
                </a>
              </small>
              <p>I checked the pins they are correct, but no reception at 5 cm. So waiting for the last parts.</p>
            </div>
          </div>
          <hr class="blog-seperator"/>
        </article>
        <ol class="children">

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    <li>
      <article id="comment-149">
          <div class="d-flex flex-row">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/F0D6E096FD45271B1A8CE970F035B72B?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Jimmy reply to Leon Arkesteijn
                
              </div>
              <small>
                <a href="#comment-149" title="Link naar deze reactie">
                  <time>Friday 30 Sep 2016 om 08:20:06</time>
                  
                </a>
              </small>
              <p>I don&rsquo;t know what your exact code looks like, but I noticed in my current code that I need to call rf.initReceive() after a call to sendCommand().
So if you send a command, call initReceive again to be able to receive.</p>
            </div>
          </div>      
        </article>
        <hr class="blog-seperator"/>
    </li>
  

  

  

  

  

  

  

  

  

  

</ol>
      </li>
      
    
      
    
      
      <li>
        <article id="comment-150">
          <div class="d-flex">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/75B63FD5B9C811A2543CF8D30EC0E917?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Marcel
                
              </div>
              <small>
                <a href="#comment-150" title="Link naar deze reactie">
                  <time>Wednesday 7 Dec 2016 om 18:32:40</time>
                  
                </a>
              </small>
              <p><p>After some setbacks (broken Wemos and CC1101) I finaly manged to get it working.
I used JIMMY&rsquo;s github code/library to create my own Frankenstein ;-)</p>

<p>It has a simple web interface and API and runs on a Nodemcu.
Feel free to use/abuse it!:
<a href="https://www.maredana.nl/itho-mechanical-ventilation-with-esp8266/">https://www.maredana.nl/itho-mechanical-ventilation-with-esp8266/</a></p>

<p>Thank you guys for creating the tools and sharing the info!</p>
</p>
            </div>
          </div>
          <hr class="blog-seperator"/>
        </article>
        <ol class="children">

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

</ol>
      </li>
      
    
      
      <li>
        <article id="comment-151">
          <div class="d-flex">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/98E85FA508FB244C07EFF8EF49C24581?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Olivier
                
              </div>
              <small>
                <a href="#comment-151" title="Link naar deze reactie">
                  <time>Wednesday 11 Jan 2017 om 19:48:46</time>
                  
                </a>
              </small>
              <p>Hi all,
many thanks for the hard work! With Jimmy&rsquo;s code and a few changes (#include  for uint_8 and remove the #include ) I got the code working on a CC1101 and a wemos D1R2 (esp8266), and it worked like a charm!
Going to link this to a DHT22 in order to automatically adjust the fan.</p>
            </div>
          </div>
          <hr class="blog-seperator"/>
        </article>
        <ol class="children">

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    <li>
      <article id="comment-152">
          <div class="d-flex flex-row">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/F0D6E096FD45271B1A8CE970F035B72B?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Jimmy reply to Olivier
                
              </div>
              <small>
                <a href="#comment-152" title="Link naar deze reactie">
                  <time>Wednesday 25 Jan 2017 om 14:10:19</time>
                  
                </a>
              </small>
              <p>Hi Olivier, can you wxplain what you mean/did with the #include and remove #include?
Perhaps I can make the code more general to keep it working on generic esp and nodemcu while also compatible with wemos?</p>
            </div>
          </div>      
        </article>
        <hr class="blog-seperator"/>
    </li>
  

  

  

  

  

  

  

</ol>
      </li>
      
    
      
    
      
    
      
      <li>
        <article id="comment-154">
          <div class="d-flex">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/D6FF71719CDBD112FEA81EA0F35E7EFC?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Rick
                
              </div>
              <small>
                <a href="#comment-154" title="Link naar deze reactie">
                  <time>Saturday 15 Apr 2017 om 11:25:48</time>
                  
                </a>
              </small>
              <p><p>Nice article.</p>

<p>Is it possible to get this work with a Aurel Tranceiver RTX MID 868 OOK?</p>

<p>I am trying to get my Itho cve work with a RFLink.</p>
</p>
            </div>
          </div>
          <hr class="blog-seperator"/>
        </article>
        <ol class="children">

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    <li>
      <article id="comment-155">
          <div class="d-flex flex-row">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/7F2A9FD369018735070D34C0331FE9C5?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Rogier Reedijk reply to Rick
                
              </div>
              <small>
                <a href="#comment-155" title="Link naar deze reactie">
                  <time>Saturday 15 Apr 2017 om 12:37:52</time>
                  
                </a>
              </small>
              <p><p>Hi Rick,</p>

<p>In theory you should be able to control the Itho with any 868MHz RF transmitter. So the Aurel transceiver could also work.</p>

<p>The challenge however, will be to write the code to sent the correct data using the specific commands for the Aurel.</p>

<p>The people on this blog that successfully controlled the Itho all used (nearly) the same chipset that Itho is using. This way it&rsquo;s easier to send the exact same data.</p>

<p>The code people have posted and used on my blog can help you decipher the protocol and maybe create an implementation for the Aurel. But it will definitely take you some time. So it&rsquo;s not a easy as copying the code found on this site.</p>

<p>If you do get it working, please let us know!</p>
</p>
            </div>
          </div>      
        </article>
        <hr class="blog-seperator"/>
    </li>
  

  

  

  

</ol>
      </li>
      
    
      
    
      
    
      
      <li>
        <article id="comment-162">
          <div class="d-flex">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/FB0A44C3BD2347BD856EA38FCDA9A6F9?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                Dobie
                
              </div>
              <small>
                <a href="#comment-162" title="Link naar deze reactie">
                  <time>Wednesday 3 Jan 2018 om 20:48:07</time>
                  
                </a>
              </small>
              <p>Hi Guys,
Thanks for the great Job you&rsquo;ve done.
I bought the hardware on Aliexpress for under 5€ and can control my fan via Internet now!
What i am missing is a way to switch the fan off completly. I suspect the fan controller does have a command for that but it was obviously not discoverd till now.
Does anyone have an Idea?</p>
            </div>
          </div>
          <hr class="blog-seperator"/>
        </article>
        <ol class="children">

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    <li>
      <article id="comment-163">
          <div class="d-flex flex-row">
            <div>
                <img class="avatar" src="https://secure.gravatar.com/avatar/F0D6E096FD45271B1A8CE970F035B72B?s=100&d=mm&r=g">
            </div>
            <div>
              <div class="author">
                JIMMY reply to Dobie
                
              </div>
              <small>
                <a href="#comment-163" title="Link naar deze reactie">
                  <time>Saturday 6 Jan 2018 om 18:40:52</time>
                  
                </a>
              </small>
              <p>If you understand Dutch, this topic might help: <a href="https://gathering.tweakers.net/forum/list_messages/1690945/0">https://gathering.tweakers.net/forum/list_messages/1690945/0</a>
There is some development around a standby mode, coming from this source: <a href="https://github.com/Klusjesman/IthoEcoFanRFT">https://github.com/Klusjesman/IthoEcoFanRFT</a></p>
            </div>
          </div>      
        </article>
        <hr class="blog-seperator"/>
    </li>
  

</ol>
      </li>
      
    
      
    
    </ol>
  

  
</section>
    


</article>


        </div>
        
    
<script defer src="https://use.fontawesome.com/releases/v5.5.0/js/all.js" integrity="sha384-GqVMZRt5Gn7tB9D9q7ONtcp4gtHIUEW/yG7h98J7IpE3kpi+srfFyyB/04OV6pG0" crossorigin="anonymous"></script>


    
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js"></script>
        
    
    <script type="text/javascript">
        
        hljs.initHighlightingOnLoad();
    </script>
    




    



    </body>
</html>
